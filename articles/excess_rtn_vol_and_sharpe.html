<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculating Excess Return, Volatility &amp; Sharpe • fintech.trading.competition</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Calculating Excess Return, Volatility &amp; Sharpe">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-9X0K4G58XL"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X0K4G58XL');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fintech.trading.competition</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/scoreboard.html">SCOREBOARD</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-scoring" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Scoring</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-scoring">
<li><a class="dropdown-item" href="../articles/Scoring.html">General Idea (start here)</a></li>
    <li><a class="dropdown-item" href="../articles/excess_rtn_vol_and_sharpe.html">Calculating Excess Return, Volatility &amp; Sharpe</a></li>
    <li><a class="dropdown-item" href="../articles/ranking.html">Fully Worked Scoring &amp; Ranking Example</a></li>
    <li><a class="dropdown-item" href="../articles/other_rules.html">Other Rules and Special Cases</a></li>
    <li><a class="dropdown-item" href="../articles/incentives.html">Incentive Structure - Discussion</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://www.youtube.com/@DukeFintechCompetition" aria-label="YouTube"><span class="fa fa-youtube"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gothic-hedge-society/fintech.trading.competition" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="excess_rtn_vol_and_sharpe_files/vembedr-0.1.5/css/vembedr.css" rel="stylesheet">
<link href="excess_rtn_vol_and_sharpe_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="excess_rtn_vol_and_sharpe_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="excess_rtn_vol_and_sharpe_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="excess_rtn_vol_and_sharpe_files/datatables-binding-0.33/datatables.js"></script><link href="excess_rtn_vol_and_sharpe_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="excess_rtn_vol_and_sharpe_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="excess_rtn_vol_and_sharpe_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="excess_rtn_vol_and_sharpe_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="excess_rtn_vol_and_sharpe_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculating Excess Return, Volatility &amp; Sharpe</h1>
            
      

      <div class="d-none name"><code>excess_rtn_vol_and_sharpe.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.dt-colnames {
color: #fcba03;
}
.dataTables_paginate, tbody {
background-color: white;
}
</style>
<div class="row">
<div class="col-sm-2"></div>
<div class="col-sm-8">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/2sPWmHHgZNA" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div class="col-sm-2"></div>
</div>
<p>At the end of every trading day – as soon as a new end-of-day Net
Account Value (NAV) for all the traders in the competition becomes
available (usually around 7pm EST) – the following process is run to
calculate the <strong>Excess Return</strong> and
<strong>Volatility</strong> for every participant.</p>
<ul>
<li>
<strong>Excess Return</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>p</mi></msub><mo>−</mo><msub><mi>r</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">R_{p} - r_{f}</annotation></semantics></math>)
is the difference between the return your portfolio earned
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>p</mi></msub><annotation encoding="application/x-tex">R_{p}</annotation></semantics></math>)
and the risk free rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>f</mi></msub><annotation encoding="application/x-tex">r_{f}</annotation></semantics></math>)</li>
<li>
<strong>volatility</strong> of returns
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\sigma_{p}</annotation></semantics></math>)
is defined as the standard deviation of your portfolio’s daily log
returns.</li>
</ul>
<p>In this section we’ll demonstrate how we calculate these numbers
using some made-up example data for a hypothetical trader.</p>
<div class="section level2">
<h2 id="example-traders-data">Example Trader’s Data<a class="anchor" aria-label="anchor" href="#example-traders-data"></a>
</h2>
<p>Let’s say that today’s date is 23 March 2021, and a student has been
participating in the competition for seven days.</p>
<p>Her end-of-day (EoD) Net Asset Value (NAV) and daily log returns
are:</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["2021-03-23","2021-03-22","2021-03-19","2021-03-18","2021-03-17","2021-03-16","2021-03-15"],[1000301,1000075,1000250,1000050,1000100,999890,999950],[0.0002259575209476716,-0.0001749715675667512,0.0001999700051658001,-4.999625029165153e-05,0.000210001050776989,-6.000480040199383e-05,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Date<\/th>\n      <th>EoD NAV<\/th>\n      <th>Port. Return (%/trd day)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 5, 3, \",\", \".\", null);\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatCurrency(data, \"$\", 2, 3, \",\", \".\", true, null);\n  }"},{"className":"dt-center","targets":"_all"},{"name":"Date","targets":0},{"name":"EoD NAV","targets":1},{"name":"Port. Return (%/trd day)","targets":2}],"initComplete":"\n      function(settings, json) {\n          $(this.api().table().header()).css({\n              'color' : 'greenyellow'\n          });\n      }\n      ","dom":"Bt","ordering":false,"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.initComplete"],"jsHooks":[]}</script><p>Note that there’s no way to calculate a return on the very first day
because there’s nothing to compare it to.</p>
<p>The student’s <strong>daily portfolio returns</strong> are the log
returns of her daily portfolio value. For example, on 18 March 2021, she
started the day with $1,000,100.00 and ended with $1,000,050.00 in total
portfolio value. Therefore the return she sees at end-of-day on 18 March
2021 was:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 'log()' here is the natural log, not base 10.</span></span>
<span><span class="va">rtn_18_mar_2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1000050.00</span> <span class="op">/</span> <span class="fl">1000100.00</span><span class="op">)</span></span>
<span><span class="fu">format_percent</span><span class="op">(</span><span class="va">rtn_18_mar_2021</span>, <span class="st">"% / trading day."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "-0.005% / trading day."</span></span></code></pre>
<p>Let’s check that, because why not? She started the day with
$1,000,100.00 NAV, so that number * (1 +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">return</annotation></semantics></math>)
should equal the $1,000,050.00 NAV that her account posted at day’s
end:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check</span></span>
<span><span class="fl">1000100.00</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">rtn_18_mar_2021</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1000050</span></span></code></pre>
<p>–&gt; Looks good.</p>
<p>The student’s overall <strong>geometric mean rate of return</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>p</mi></msub><annotation encoding="application/x-tex">R_{p}</annotation></semantics></math>
for the entire time period is:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">student_gmrr</span> <span class="op">&lt;-</span> <span class="va">student_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"Port. Return (%/trd day)"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Port. Return (%/trd day)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">.</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span><span class="fu">format_percent</span><span class="op">(</span><span class="va">student_gmrr</span>, <span class="st">"% / trading day."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "0.005848% / trading day."</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="what-risk-free-rate-do-we-use">What risk-free rate do we use?<a class="anchor" aria-label="anchor" href="#what-risk-free-rate-do-we-use"></a>
</h2>
<p>The Gothic Hedge Society (who runs the trading competition) reasons
that on Day 1, all participants implicitly decide if they’re going to
actively trade at all, as opposed to simply putting all of their money
into risk-free debt with a maturity near the Competition’s end date.</p>
<p>Sounds like not a lot of fun and not a good way to make a fortune…
but since about half of the participants will <em>lose</em> money in
this contest, the idea isn’t actually as bad as it might sound.</p>
<p>Regardless, for the duration of the Competition, the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>f</mi></msub><annotation encoding="application/x-tex">r_{f}</annotation></semantics></math>
used to calculate Sharpes does not change, even though new risk-free
rates will be published every day by the USDT. The reason why we keep
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>f</mi></msub><annotation encoding="application/x-tex">r_{f}</annotation></semantics></math>
fixed is because we’re comparing your performance as a trader to the
“base strategy”: simply buying debt earning
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>f</mi></msub><annotation encoding="application/x-tex">r_{f}</annotation></semantics></math>
on Day 1, which would tie up all your capital for trading until maturity
on the last day.</p>
<p>Since the Competition lasts about <strong>3 months</strong>, the
value we’ll use for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>f</mi></msub><annotation encoding="application/x-tex">r_{f}</annotation></semantics></math>
will be whatever the USDT publishes as the 3-month CMT rate on the day
the Competition starts. This value will be will be posted clearly and
conspicuously for everyone.</p>
<p><strong>For this example</strong>, let’s suppose that on Day 1 we
visited the USDT’s website and found that the 3-month CMT rate was 0.04%
(annualized).</p>
<p>We want that on a trading day basis, so we’ll convert: since there
are 252 trading days in a year, we divide by 252 (and by 100 because
it’s a percent):</p>
<p>Let’s do that now, and store
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>f</mi></msub><annotation encoding="application/x-tex">r_{f}</annotation></semantics></math>
as a variable:</p>
<pre><code><span><span class="co">## [1] "The risk-free rate is 0.0001587% / trading day."</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="excess-return">Excess Return<a class="anchor" aria-label="anchor" href="#excess-return"></a>
</h2>
<p>Now that we have values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>p</mi></msub><annotation encoding="application/x-tex">R_{p}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>f</mi></msub><annotation encoding="application/x-tex">r_{f}</annotation></semantics></math>
student’s <strong>excess return</strong> is</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">student_excess_return</span> <span class="op">&lt;-</span> <span class="va">student_gmrr</span> <span class="op">-</span> <span class="va">rf</span></span>
<span><span class="fu">format_percent</span><span class="op">(</span><span class="va">student_excess_return</span>, <span class="st">"% / trading day."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "0.005689% / trading day."</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="volatility">Volatility<a class="anchor" aria-label="anchor" href="#volatility"></a>
</h2>
<p>The students <strong>volatility of returns</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\sigma_{p}</annotation></semantics></math>
is the standard deviation of her portfolio returns:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">student_vol</span> <span class="op">&lt;-</span> <span class="va">student_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"Port. Return (%/trd day)"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Port. Return (%/trd day)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">format_percent</span><span class="op">(</span><span class="va">student_vol</span>, <span class="st">"% / trading day."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "0.0174% / trading day."</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="sharpe-ratio">Sharpe ratio<a class="anchor" aria-label="anchor" href="#sharpe-ratio"></a>
</h2>
<p>We now have everything we need to calculate this trader’s Sharpe
ratio:</p>
<p><span class="math display">$$\begin{align*}
{\tt Sharpe\ Ratio} = \frac{R_{p} - r_{f}}{\sigma_{p}}
\end{align*}$$</span></p>
<div class="section level4">
<h4 id="wherein">Wherein:<a class="anchor" aria-label="anchor" href="#wherein"></a>
</h4>
<p><span class="math display">$$\begin{align*}
R_{p} &amp; {\sf: Portfolio\ Return} \\
r_{f} &amp; {\sf: Risk\ free\ rate\ of\ return} \\
\sigma_{p} &amp; {\sf: Volatility\ of\ portfolio\ return}
\end{align*}$$</span></p>
</div>
</div>
<div class="section level2">
<h2 id="her-sharpe-is-therefore">Her Sharpe is therefore:<a class="anchor" aria-label="anchor" href="#her-sharpe-is-therefore"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">student_Sharpe</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">student_gmrr</span> <span class="op">-</span> <span class="va">rf</span><span class="op">)</span> <span class="op">/</span> <span class="va">student_vol</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">student_Sharpe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3270215</span></span></code></pre>
<div class="section level4">
<h4 id="matching-up-calculations-w-excel-and-other-programs-a-quick-note">Matching up Calculations w/ Excel and Other Programs (a quick
note)<a class="anchor" aria-label="anchor" href="#matching-up-calculations-w-excel-and-other-programs-a-quick-note"></a>
</h4>
<p>As simple as it may seem, calculating logarithms can differ slightly
(or sometimes, significantly) depending on the precision of the program
you use. It’s possible to get different answers for the same log calcs
in Excel, R, and Python, and the difference gets magnified when
calculating GMRR.</p>
<p>Therefore, don’t worry too much if you try to follow along this
example and wind up with numbers that differ slightly. For the purposes
of fairness in the competition, it only matters that we use the same
program for everyone – which, in this case, is the <em>log</em>()
function in R.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/JakeVestal" class="external-link">Jake Vestal</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
