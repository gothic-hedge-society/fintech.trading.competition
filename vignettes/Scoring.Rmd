---
title: "Scoring"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Bottom Line
The winner is the participant who posts the highest Sharpe Ratio, with respect 
to the S&P 500 index, at the end of the competition.

To put it even more succinctly: **You win by beating the S&P 500, taking as 
little risk as possible in so doing**.

## Example: Wild Bill & Clever Susan
Let's say that at the end of the competition we have two students: a reckless
gambler named Wild Bill and a shrewd trader named Clever Susan.

#### Wild Bill
Bill puts all of his money into a tiny, risky startup that has just been listed
on the NASDAQ. He then forgets about it and lets it ride until the end of the
competition, at which time he's earned an amazing 250% return!!!! He clearly
should win the competition, right?

Well... when you look at the value of Wild Bill's performance, it was all over
the map during the competition. As news was released about the startup, Bill was
down as much as -300% on some days, and up as high as 375% because the tiny
company's price was fluctuating so much. 

That means, that if Wild Bill had had a cash emergency or needed to close his
position and withdraw his investment at any time, there's no telling how much
he'd have had available on a given day. Maybe he'd have a lot of cash, maybe not
much at all.

In fact, the next day after the competition, Bill's gains were wiped out and he
was down a full -50% from where he started, meaning that in reality, Bill just
got lucky that the competition ended when it did. Clearly, there's more to the
story here.


#### Clever Susan 
Susan takes a different approach. She creates a well-balanced
portfolio of different assets in different maket sectors, and at the end of the
competition she posts a very healthy 12% return -- much less than Wild Bill.

However, the value of Susan's portfolio grew steadily and predictably through
the competition. On her worst day, she had still earned a return of 8%, but upon
the whole it never varied too much from 12%.

## So who should win-- Wild Bill or Clever Susan?
In other words, how do we quantify the difference between these two students?

Investment performance is scored by calculating the **Sharpe Ratio** of your
end-of-day account balance over time. The Sharpe Ratio is a measure of your
*risk-adjusted return*; in other words, how much money you made vs. the risk
that you took on.

In finance, **risk = volatility and is defined as the standard deviation of the
returns that a portfolio earns over time**. You want as large a return and as
small a volatility of returns as possible.

This is the entire game and the goal of every investor: high returns, low
volatility. The Sharpe Ratio is a way to quantify this concept. Read on to learn
more about the components of this very important metric and how it's calculated.

## Daily Log Returns
Your return is calculated each day by observing the end-of-day value of all your
assets (in other words, your portfolio's Net Asset Value (NAV)) and comparing it 
to the end-of-day value on the day before. That means that over a period of $N$ 
days, we'll have $N - 1$ total observations of a portfolio's return because you can't measure a return for the very first day -- you have nothing to compare it to.

The formula used to calculate the return you earned on your portfolio is the log
ratio of $V_{N}$ -- the value of your portfolio on Day $N$ -- divided by
$V_{N-1}$ -- the portfolio's value on the previous day; i.e., $R_{N} =
\log(\frac{V_{N}}{V_{N-1}})$.

In the competition, daily log returns are calculated for every student's
portfolio *and* for the S&P 500 index.

## Average ("Expected") Return
**TLDR**: We use the geometric mean of period-over-period log returns.

**Details**: Let's say you invest $100k into an investment portfolio. Each
quarter, you measure the return you earned at the quarter's end with respect to
the how much the portfolio was worth at the beginning of the portfolio. You
observe the returns +25%, -25%, +25%, -25% for each quarter. In other words, an
initial investment of $100k would be worth $125k, $100k, $125k, and $100k at the
ends of quarters 1, 2, 3, and 4, respectively.

The question is, **what's the overall return that characterizes this
investment's performance over the year**?

#### Arithmetic Mean
You might think: "just take the average" of the returns, which works out to
2.5%. But that's not quite descriptive of the whole picture is it... after all,
if you tell a client that you earned an average of 2.5% on their investment of
$100k, then they'd naturally expect to see something around $102.5k when they
look up the value of the account right?

...but the value of the account is $100k, meaning that you're probably going to
have a client banging your door down wondering where their $2,500 went. The
"normal average", more properly called the **arithmetic mean** of the returns is
therefore misleading in this way!

#### Geometric Mean
A better way to assign an overall charactaristic ("expected") return for a time
series of returns is to use the [geometric
mean](https://www.investopedia.com/ask/answers/06/geometricmean.asp#:~:text=The%20geometric%20mean%20differs%20from,returns%20than%20the%20arithmetic%20mean),
calculated by multiplying all of the returns together and taking the $n$th root,
where $n$ is the number of returns observed in the period. The **geometric
mean** of a series of returns over $n$ periods can be expressed as two
equivalent formulae $\left(\prod_{i=1}^{n}R_{i}\right)^\frac{1}{n}$ and
$\sqrt[n]{R_{1}R_{1}R_{1}...R_{n}}$.

Note that, in the example above, the geometric mean rate of return for the
investment is 0, just as it should be.

## Excess Return
You're going to be managing a portfolio -- some set of bonds, stocks, currency
trades, etc, on which you earn a **portfolio return** $R_{p}$. As an investor,
you only care about earning a return that is *better* than some benchmark 
investment that you consider to be a "default case".

In other words, what you really care about is your portfolio's **Excess Return**
over some benchmark.

## Choosing the Benchmark
Excess Return is often defined as the difference between the return your 
portfolio earned and the **risk-free rate of return** that was available by buying 
sovereign debt during a comparable time period; in other words, $R_{p} - r_{f}$,
wherein $r_{f}$ denotes the risk-free rate.

In most cases, that definition of excess return makes sense. 

However, **for the trading competition we'll be using the returns of the S&P 500 
index as our benchmark**. The reason for this choice is twofold: 

  1. The Competition admin considers the "base case" trading strategy to be: 
    "buy an S&P 500 index fund (such as IVV) on Day 1 of the contest and hold it
    until the last day". We wish to compare everyone's performance against that.
  2. If the risk-free rate is chosen as the benchmark then it's possible to run
    strategies that yield VERY small, but positive, excess return with EVEN 
    SMALLER volatility, which yield huge Sharpe Ratios when the final results 
    are calculated but result in very little actual money made.
    
In symbols, the Competition's definition of risk-free rate is $R_{p} - r_{SP500}$
wherein $r_{SP500}$ denotes the daily log return of the S&P 500 index.

## Volatility (Risk)
For a series of returns, the **volatility** (or "vol", for short) is defined as
the standard deviation of the observed returns. In finance, **risk** is thought
to be defined as **volatility of an asset's return**. A portfolio's vol is 
assigned the symbol $\sigma^{2}_{p}$.

## The Sharpe Ratio
Now we can put it all together and, [as William Sharpe did in
1966](http://web.stanford.edu/~wfsharpe/art/sr/SR.htm), write down a metric that
goes *down* when expected return goes down & vol goes up, and *up* when expected
return goes up and vol goes down:

\begin{align*}
{\tt Sharpe\ Ratio} = \frac{R_{p} - r_{SP500}}{\sigma^{2}_{p}} 
\end{align*}

#### Wherein:

\begin{align*}
R_{p} & {\sf: Portfolio\ Return} \\
r_{SP500} & {\sf: SP500\ rate\ of\ return} \\
\sigma^{2}_{p} & {\sf: Volatility\ of\ portfolio\ return}
\end{align*}
